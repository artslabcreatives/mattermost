# Mattermost Production Environment Configuration
# Copy this file to .env and customize the values for your deployment

# =============================================================================
# Database Configuration (Host PostgreSQL)
# =============================================================================
# PostgreSQL connection details for the database running on the host server
# Make sure PostgreSQL is configured to accept connections from Docker containers
# (update pg_hba.conf and postgresql.conf if needed)

POSTGRES_USER=mmuser
POSTGRES_PASSWORD=change_this_secure_password_123
POSTGRES_DB=mattermost

# =============================================================================
# Mattermost Server Configuration
# =============================================================================
# Site URL - The URL users will use to access Mattermost (REQUIRED)
# Examples: https://chat.example.com or http://192.168.1.100:8065
MM_SITEURL=http://localhost:8065

# Server ports
MM_PORT=8065
MM_PORT_CALLS=8443

# Enable developer mode (set to false in production)
MM_ENABLE_DEVELOPER=false

# =============================================================================
# Email Configuration
# =============================================================================
# Enable email/username authentication
MM_EMAIL_SIGNUP=true
MM_EMAIL_SIGNIN=true
MM_USERNAME_SIGNIN=true

# SMTP Email settings (for email notifications)
MM_SEND_EMAIL=false
MM_SMTP_SERVER=smtp.example.com
MM_SMTP_PORT=587
MM_SMTP_USERNAME=
MM_SMTP_PASSWORD=
MM_FEEDBACK_EMAIL=no-reply@example.com
MM_REPLYTO_EMAIL=no-reply@example.com

# =============================================================================
# Security Configuration
# =============================================================================
# Enable Multi-Factor Authentication
MM_ENABLE_MFA=false

# =============================================================================
# System Configuration
# =============================================================================
# Timezone
TZ=UTC

# =============================================================================
# Notes
# =============================================================================
# 1. After changing .env, restart with: docker compose -f docker-compose.prod.yml up -d
# 2. For HTTPS/SSL, use a reverse proxy (nginx, Caddy) in front of Mattermost
# 3. Configure email settings to enable notifications and password resets
# 4. Change POSTGRES_PASSWORD before first deployment
# 5. Set MM_SITEURL to your actual domain/IP for proper functionality

# =============================================================================
# Typesense Configuration
# =============================================================================
# Typesense API key (change in production)
TYPESENSE_API_KEY=xyz

# Typesense data path (persisted to host)
TYPESENSE_DATA_PATH=./volumes/typesense/data

# Typesense search engine settings
MM_TYPESENSESETTINGS_CONNECTIONURL=http://typesense:8108
MM_TYPESENSESETTINGS_APIKEY=xyz
MM_TYPESENSESETTINGS_ENABLEINDEXING=false
MM_TYPESENSESETTINGS_ENABLESEARCHING=false
MM_TYPESENSESETTINGS_ENABLEAUTOCOMPLETE=false

# =============================================================================
# Volume Paths
# =============================================================================
MATTERMOST_CONFIG_PATH=./volumes/app/mattermost/config
MATTERMOST_DATA_PATH=./volumes/app/mattermost/data
MATTERMOST_LOGS_PATH=./volumes/app/mattermost/logs
MATTERMOST_PLUGINS_PATH=./volumes/app/mattermost/plugins
MATTERMOST_CLIENT_PLUGINS_PATH=./volumes/app/mattermost/client/plugins
MATTERMOST_BLEVE_INDEXES_PATH=./volumes/app/mattermost/bleve-indexes

# Restart policy
RESTART_POLICY=unless-stopped
